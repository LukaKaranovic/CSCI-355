# Excitation Tables
An excitation table shows the minimum input signals needed to change a flip-flop from its current state to a specific next state.
![[excitation_table.png]]

# FSM Design Steps
Design Steps  
1. Obtain the specification of the desired circuit.  
	- Description of input and output relationship  
2. Convert specification to a state diagram.  
3. Derive the corresponding state table.  
4. Reduce the number of states if possible.  
5. Decide on the number of state variables.  
6. Choose the type of flip-flops to be used.  
7. Derive the logic expressions needed to implement the circuit.

# Moore State Model
In a Moore-type machine, the output values are generated based only on the **present state of the circuit** (not on input)
- Output remains stable over entire clock pulse and changes only after a state change and next clock transition.
- State and value of output are shown together inside of a circle (State / value = \<value>)

## Designing a Moore Model

### Step 1 - Obtain the Specifications
Consider an application where the speed to an automatically-controlled vehicle has to be regulated:  
- The vehicle is designed to run at some predetermined speed  
- If the speed exceeds the desirable limit, the vehicle needs to be slowed down 
- The speed is measured at regular intervals  
- Let binary signal w indicate whether the speed exceeds the required limit (w = 0 means speed is within acceptable range)  
- If w = 1 for two or more consecutive measurements, a control signal z must be asserted  
- Let a signal Clock define the required timing intervals

We know:
1. The circuit has one input w and one output z
2. All changes in the circuit occur on the posedge of the clock signal
3. Output z = 1 if w was 1 for the last 2 clock cycles. Otherwise, z = 0.

### Step 2 - State Diagram
Determine how many states are needed and which transitions are possible from state to state.

A good idea is for each state to think about all possible changes in input from that state and what would happen.
![[moore_state_diagram.png]]

### Step 3 - State Table
It is more convenient for implementation to translate the information from the state diagram to a table form.
![[moore_state_table.png]]

### Step 4 - Reduce Number of States if Possible
Can we do this? Not in this case.

### Step 5 - State Assignment / Decide on Number of State Variables
We have three states: A, B, and C
- Each state is represented by a combination of **state variables**
- Each state variable may be implemented as a flip-flop

Since we have three states, we need two state variables.
- We represent each state as a binary number, and we need two bits to count up to 3.

Say we choose A = 00, B = 01, and C = 10. The resulting **state-assigned table** is:
![[moore_state_assigned.png]]

### Step 6 - Choose the Type of Flip-flops to be Used
What type of flip-flop do we use?
- D-type flip-flops are the most straightforward to use
	- Next state-variables are connected directly to the D inputs of the flip-flops
- JK flip-flops can also be used in this situation
	- Need to follow JK flip-flop excitation table to obtain associated J and K input values.

### Step 7 - Derivation of Next-State and Output Expressions
From the state-assigned table, we can derive logic expressions for the **next-state** and **output** functions.

For each state variable:
- Determine the D inputs to the D flip-flops which aer the same as the expression for the next-state Y2 and Y1 based on our state-assigned table.
- Use K-maps to simplify.

- For Y1 on every current state (y2y1) and every input (w is 0 or 1):
	- This is because our Y1 value is the input D for the first D flip-flop
- ![[moore_derivation.png]]
- For Y2 on every current state (y2y1) and every input (w is 0 or 1):
	- This is because our Y1 value is the input D for the first D flip-flop
- ![[moore_derivation2.png]]

Now, use a K-map to determine the expression for output z based on current state:
- ![[moore_derivation_output.png]]

### Step 8 - Implement the Circuit
![[moore_circuit.png]]

# Mealy State Model
In a Mealy-type machine, the output values are generated based on both the state of the circuit and the present values of its inputs.
- Provides additional flexibility in the design of sequential circuits
- Requires less number of states than Moore model (less hardware)
- Output is generated one clock cycle earlier than Moore model.

## Designing a Mealy Model
### Step 1 - Obtain the Specifications
Same specifications as Moore model, we're doign the same circuit.

We know:
1. The circuit has one input w and one output z
2. All changes in the circuit occur on the posedge of the clock signal
3. Output z = 1 if w was 1 for the last 2 clock cycles. Otherwise, z = 0.

### Step 2 - State Diagram
Can be implemented using just two states.
- We consider previous output as input here.
- Outputs are shown in state transitions rather than in the states.
![[mealy_state_diagram.png]]

### Step 3 - State Table
![[mealy_state_table.png]]
- Since output isn't based on the state, but the combination of the state and the current input, we must define output using columns for input and rows for state.

### Step 4 - Reduce States if Possible
Can't in this case.

### Step 5 - State Assignment / Decide on State Variables
We only need one state variable because we have two states.
![[mealy_state_assigned.png]]

### Step 6 - Choose Type of Flip-flop to use
Here, we can use D flip-flops.

### Step 7 - Derivation of Next-State and Output Expressions
![[mealy_derivation_state.png]]
- We see that Y = w.
- Our D input for flip-flop is Y, so D = Y = w

![[mealy_derivation_output.png]]
- We see that z = yw

### Step 8 - Implement the Circuit
![[mealy_circuit.png]]
- Don't need to loop back y as Y for input D since Y = w. Just use w's signal.



Overall, the Mealy implementation is simpler but the timing diagram is different (less delay):
- We can make them the same by adding a delay on the output of the Mealy machine
	- Makes it a Moore machine and effectively the same circuit.